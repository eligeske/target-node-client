/** ***********************************************************************
 * ADOBE CONFIDENTIAL
 * ___________________
 *
 *  Copyright 2018 Adobe Systems Incorporated
 *  All Rights Reserved.
 *
 * NOTICE:  All information contained herein is, and remains
 * the property of Adobe Systems Incorporated and its suppliers,
 * if any.  The intellectual and technical concepts contained
 * herein are proprietary to Adobe Systems Incorporated and its
 * suppliers and are protected by all applicable intellectual property
 * laws, including trade secret and copyright laws.
 * Dissemination of this information or reproduction of this material
 * is strictly forbidden unless prior written permission is obtained
 * from Adobe Systems Incorporated.
 ************************************************************************* */
const {
  BATCH_MBOX_INDEX_ID_REQUIRED,
  BATCH_MBOX_NAME_REQUIRED
} = require("../common/messages");

const HASH = "#";
const PIPE = "|";

const SDK_NAME = "AdobeTargetNode";
const SDK_NAME_HEADER_KEY = "X-EXC-SDK";
const SDK_VERSION_HEADER_KEY = "X-EXC-SDK-Version";
const SDK_REQUEST_ID_HEADER_KEY = "X-Request-Id";
const BATCH_SESSION_ID_HEADER_KEY = "session-id";

const VISITOR_ID_KEY = "marketingCloudVisitorId";
const MBOX_PARAMETERS = "mboxParameters";
const MCSDID_PARAMETER = "mboxMCSDID";
const AAMB_PARAMETER = "mboxAAMB";
const MCGLH_PARAMETER = "mboxMCGLH";
const EDGE_CLUSTER_PREFIX = "mboxedge";
const HOST = "tt.omtrdc.net";
const MBOX_ENDPOINT = "/rest/v1/mbox/";
const PROTOCOL = "http://";
const SECURE_PROTOCOL = "https://";
const TIMEOUT = 3000;
const DEVICE_ID_KEY = "tntId";
const SESSION_ID_KEY = "sessionId";
const CONTENT_KEY = "content";
const TRACE_KEY = "mboxTrace";
const EDGE_HOST_KEY = "edgeHost";
const SESSION_ID_MAX_AGE = 1860;
const DEVICE_ID_MAX_AGE = 63244800;
const LOCATION_HINT_MAX_AGE = 1860;
const AT_PREFIX = "AT:";
const REQUEST_SENT = "request sent";
const RESPONSE_RECEIVED = "response received";

// Batch V2 API specific stuff
const BATCH_MBOXES_RESPONSE_KEY = "mboxResponses";
const BATCH_MBOX_ENDPOINT = "/rest/v2/batchmbox/";
const BATCH_REQUEST_ALLOWED_FIELDS = [
  "id",
  "profileParameters",
  "contentAsJson",
  "mboxes",
  "mboxOverride"
];
const BATCH_RESPONSE_ALLOWED_FIELDS = [
  "requestId",
  "id",
  "client",
  "contentAsJson",
  "mboxResponses",
  "trace"
];
const BATCH_MBOX_RESPONSE_FIELDS = [
  "mbox",
  "content",
  "responseTokens",
  "trace"
];
const BATCH_VISITOR_ID_KEY = "id";
const BATCH_MBOX_REQUIRED_FIELDS = [
  ["mbox", BATCH_MBOX_NAME_REQUIRED],
  ["indexId", BATCH_MBOX_INDEX_ID_REQUIRED]
];
const BATCH_REQUEST_SDID_KEY = "supplementalDataId";
const BATCH_REQUEST_AAM_PARAMS_KEY = "aamParameters";
const MBOX_PARAMS_TO_AAM_PARAMS = {
  mboxAAMB: "blob",
  mboxMCGLH: "dcsLocationHint"
};
const AUTH_STATE = {
  0: "unknown",
  1: "authenticated",
  2: "logged_out"
};

module.exports = {
  HASH,
  PIPE,
  SDK_NAME,
  SDK_NAME_HEADER_KEY,
  SDK_VERSION_HEADER_KEY,
  SDK_REQUEST_ID_HEADER_KEY,
  VISITOR_ID_KEY,
  MBOX_PARAMETERS,
  MCSDID_PARAMETER,
  AAMB_PARAMETER,
  MCGLH_PARAMETER,
  EDGE_CLUSTER_PREFIX,
  HOST,
  MBOX_ENDPOINT,
  BATCH_MBOX_ENDPOINT,
  PROTOCOL,
  SECURE_PROTOCOL,
  TIMEOUT,
  DEVICE_ID_KEY,
  SESSION_ID_KEY,
  CONTENT_KEY,
  TRACE_KEY,
  EDGE_HOST_KEY,
  SESSION_ID_MAX_AGE,
  DEVICE_ID_MAX_AGE,
  LOCATION_HINT_MAX_AGE,
  AT_PREFIX,
  REQUEST_SENT,
  RESPONSE_RECEIVED,
  BATCH_MBOXES_RESPONSE_KEY,
  BATCH_REQUEST_ALLOWED_FIELDS,
  BATCH_RESPONSE_ALLOWED_FIELDS,
  BATCH_MBOX_RESPONSE_FIELDS,
  BATCH_VISITOR_ID_KEY,
  BATCH_MBOX_REQUIRED_FIELDS,
  BATCH_REQUEST_SDID_KEY,
  BATCH_REQUEST_AAM_PARAMS_KEY,
  BATCH_SESSION_ID_HEADER_KEY,
  MBOX_PARAMS_TO_AAM_PARAMS,
  AUTH_STATE
};
